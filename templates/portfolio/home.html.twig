{% extends 'base.html.twig' %}

{% block body %}
  {% set totalSignals = stats.projects + stats.skills + stats.experience + stats.education + stats.hobbies %}

  <section class="section">
    <div class="container-shell grid gap-8 lg:grid-cols-[1.6fr,1fr] lg:items-stretch">
      <div class="card grid-noise p-7 md:p-10" data-reveal>
        <div class="flex flex-wrap items-center gap-3">
          <span class="badge">{{ 'section.highlights'|trans }}</span>
          <span class="glass-pill">{{ 'ui.profile_snapshot'|trans }} {{ totalSignals }}</span>
        </div>

        {% if contactInfo %}
          <h1 class="hero-title mt-5">{{ localized(contactInfo, 'headline', app.request.locale) }}</h1>
          <p class="mt-4 max-w-3xl text-base text-muted md:text-lg">{{ localized(contactInfo, 'summary', app.request.locale) }}</p>
        {% endif %}

        <div class="mt-7 flex flex-wrap gap-3">
          <a class="button-primary" href="{{ path('projects', {'_locale': app.request.locale}) }}">{{ 'cta.view_projects'|trans }}</a>
          <a class="button-outline" href="{{ path('contact', {'_locale': app.request.locale}) }}">{{ 'cta.contact'|trans }}</a>
        </div>

        <div class="mt-8 grid gap-3 sm:grid-cols-3">
          <div class="stat-tile">
            <div class="text-[11px] font-bold uppercase tracking-[0.2em] text-slate-400">{{ 'ui.case_studies'|trans }}</div>
            <div class="mt-2 text-3xl font-black text-ink" data-counter="{{ stats.projects }}">0</div>
          </div>
          <div class="stat-tile">
            <div class="text-[11px] font-bold uppercase tracking-[0.2em] text-slate-400">{{ 'ui.core_skills'|trans }}</div>
            <div class="mt-2 text-3xl font-black text-ink" data-counter="{{ stats.skills }}">0</div>
          </div>
          <div class="stat-tile">
            <div class="text-[11px] font-bold uppercase tracking-[0.2em] text-slate-400">{{ 'ui.career_milestones'|trans }}</div>
            <div class="mt-2 text-3xl font-black text-ink" data-counter="{{ stats.experience + stats.education }}">0</div>
            <div class="mt-1 text-[10px] font-semibold uppercase tracking-[0.15em] text-slate-400">{{ 'ui.career_milestones_hint'|trans }}</div>
          </div>
        </div>
      </div>

      <div class="card card-at-glance p-7" data-reveal>
        <div class="at-glance-header">
          <div class="at-glance-copy">
            <div class="text-xs font-bold uppercase tracking-[0.2em] text-slate-400">{{ 'ui.profile_strength'|trans }}</div>
            <h2 class="mt-2 text-3xl text-ink">{{ 'ui.readiness_index'|trans }}</h2>
          </div>
          {% if contactInfo and contactInfo.photoPath %}
            <img class="profile-photo at-glance-photo" src="{{ asset('uploads/profile/' ~ contactInfo.photoPath) }}" alt="{{ contactInfo.displayName }}">
          {% else %}
            <div class="profile-photo at-glance-photo flex items-center justify-center text-lg font-black tracking-[0.2em] text-slate-500">IT</div>
          {% endif %}
        </div>

        <div class="mt-5 grid gap-3 sm:grid-cols-2">
          <div class="stat-tile">
            <div class="text-[11px] font-bold uppercase tracking-[0.2em] text-slate-400">{{ 'ui.documented_entries'|trans }}</div>
            <div class="mt-2 text-3xl font-black text-ink" data-counter="{{ totalSignals }}">0</div>
          </div>
          <div class="stat-tile">
            <div class="text-[11px] font-bold uppercase tracking-[0.2em] text-slate-400">{{ 'ui.approved_testimonials'|trans }}</div>
            <div class="mt-2 text-3xl font-black text-ink" data-counter="{{ stats.testimonials }}">0</div>
          </div>
        </div>

        <div class="mt-6 grid gap-3">
          <div class="stat-tile">
            <div class="text-[11px] font-bold uppercase tracking-[0.2em] text-slate-400">{{ 'nav.experience'|trans }}</div>
            <div class="mt-2 text-2xl font-black text-ink" data-counter="{{ stats.experience }}">0</div>
          </div>
          <div class="stat-tile">
            <div class="text-[11px] font-bold uppercase tracking-[0.2em] text-slate-400">{{ 'nav.education'|trans }}</div>
            <div class="mt-2 text-2xl font-black text-ink" data-counter="{{ stats.education }}">0</div>
          </div>
          <div class="stat-tile">
            <div class="text-[11px] font-bold uppercase tracking-[0.2em] text-slate-400">{{ 'nav.hobbies'|trans }}</div>
            <div class="mt-2 text-2xl font-black text-ink" data-counter="{{ stats.hobbies }}">0</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container-shell">
      <div class="flex flex-wrap items-end justify-between gap-4">
        <div>
          <div class="section-subtitle">{{ 'nav.projects'|trans }}</div>
          <h2 class="section-title">{{ 'ui.featured_work'|trans }}</h2>
        </div>
        <a class="button-outline" href="{{ path('projects', {'_locale': app.request.locale}) }}">{{ 'cta.view_projects'|trans }}</a>
      </div>

      <div class="mt-8 grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        {% for project in projects %}
          <article class="card flex h-full flex-col gap-4" data-reveal>
            <div class="flex items-center justify-between text-[11px] font-bold uppercase tracking-[0.2em] text-slate-400">
              <span>#{{ "%02d"|format(loop.index) }}</span>
              <span>{{ 'ui.case_study'|trans }}</span>
            </div>
            {% if project.imagePath %}
              <img class="h-40 w-full rounded-2xl object-cover" src="{{ asset('uploads/projects/' ~ project.imagePath) }}" alt="{{ localized(project, 'title', app.request.locale) }}">
            {% endif %}
            <div>
              <h3 class="text-2xl text-ink">{{ localized(project, 'title', app.request.locale) }}</h3>
              <p class="mt-3 text-sm text-muted">{{ localized(project, 'shortDescription', app.request.locale) }}</p>
            </div>
            {% if project.projectUrl %}
              <a class="button-outline mt-auto" href="{{ project.projectUrl }}" target="_blank" rel="noopener">{{ 'ui.visit_project'|trans }}</a>
            {% endif %}
          </article>
        {% else %}
          <div class="card">{{ 'ui.empty_projects'|trans }}</div>
        {% endfor %}
      </div>
    </div>
  </section>

  {% if testimonials is not empty %}
    <section class="section">
      <div class="container-shell">
        <div class="section-subtitle">{{ 'nav.testimonials'|trans }}</div>
        <h2 class="section-title">{{ 'ui.client_feedback'|trans }}</h2>

        <div class="mt-8 grid gap-6 md:grid-cols-2 lg:grid-cols-3">
          {% for testimonial in testimonials %}
            <div class="card" data-reveal>
              <div class="text-xs font-bold uppercase tracking-[0.2em] text-slate-400">{{ 'ui.recommendation'|trans }}</div>
              <p class="mt-3 text-sm text-muted">"{{ localized(testimonial, 'content', app.request.locale) }}"</p>
              <div class="mt-5 text-sm font-semibold text-ink">{{ testimonial.authorName }}</div>
              {% if localized(testimonial, 'authorRole', app.request.locale) %}
                <div class="text-xs font-bold uppercase tracking-[0.2em] text-slate-400">{{ localized(testimonial, 'authorRole', app.request.locale) }}</div>
              {% endif %}
            </div>
          {% endfor %}
        </div>
      </div>
    </section>
  {% endif %}
{% endblock %}
